{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[22],{a119:function(t,e,r){\"use strict\";r.r(e);var i=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r(\"q-page\",{staticClass:\"flex\"},[r(\"div\",{staticClass:\"col\"},[r(\"div\",{staticClass:\"row q-ml-lg\"},[r(\"h2\",{staticClass:\"q-mb-sm\"},[t._v(\"Manuscript Configs\")])]),r(\"q-separator\",{attrs:{inset:\"\"}}),r(\"div\",{staticClass:\"row-12 q-ma-lg\"},[r(\"q-input\",{ref:\"titleInput\",staticStyle:{\"font-size\":\"1rem\"},attrs:{label:\"Title:\",\"label-color\":\"primary\",filled:\"\",rules:[function(t){return null!==t&&\"\"!==t||\"Please type the title\"},function(t){return t.length<=100||\"Title must be smaller than 100\"}]},on:{input:t.editTitle,blur:t.editTitle},model:{value:t.title,callback:function(e){t.title=e},expression:\"title\"}})],1),r(\"div\",{staticClass:\"row-12 q-mx-lg\"},[r(\"q-input\",{ref:\"descriptionInput\",staticStyle:{\"font-size\":\"1rem\"},attrs:{label:\"Description:\",\"label-color\":\"primary\",filled:\"\",rules:[!0],autogrow:\"\"},on:{input:t.editDescription,blur:t.editDescription},model:{value:t.description,callback:function(e){t.description=e},expression:\"description\"}})],1),t.$store.getters[\"write/manuscriptProperty\"](\"front_cover\")?r(\"q-btn\",{staticClass:\"q-ma-lg\",attrs:{outline:\"\",color:\"positive\",label:\"Front Cover\",icon:\"check_circle\"},on:{click:function(e){t.clear_cover=!0,t.coverToBeCleared=\"front_cover\"}}}):r(\"file-uploader\",{staticClass:\"q-ma-lg\",attrs:{label:\"Front Cover\"},on:{upload:t.handleUpload}}),t.$store.getters[\"write/manuscriptProperty\"](\"back_cover\")?r(\"q-btn\",{staticClass:\"q-ma-lg\",attrs:{outline:\"\",color:\"positive\",label:\"Back Cover\",icon:\"check_circle\"},on:{click:function(e){t.clear_cover=!0,t.coverToBeCleared=\"back_cover\"}}}):r(\"file-uploader\",{staticClass:\"q-ma-lg\",attrs:{label:\"Back Cover\"},on:{upload:t.handleUpload}}),r(\"div\",{staticClass:\"row-12 q-ma-md\"},[r(\"q-tree\",{ref:\"optionsTree\",staticClass:\"col-12 col-sm-6\",attrs:{nodes:t.options,\"node-key\":\"body\",\"tick-strategy\":\"strict\",ticked:t.ticked},on:{\"update:ticked\":[function(e){t.ticked=e},t.handleTicked]}})],1),r(\"div\",[r(\"q-btn\",{staticClass:\"q-ma-md\",attrs:{color:\"primary\",label:\"Publish\",size:\"large\"},on:{click:function(e){t.confirm_publish=!0}}},[t.loading?r(\"q-spinner-hourglass\",{attrs:{color:\"white\",size:\"1.2em\"}}):t._e()],1)],1),r(\"q-dialog\",{ref:\"clearCoverDialog\",model:{value:t.clear_cover,callback:function(e){t.clear_cover=e},expression:\"clear_cover\"}},[r(\"q-card\",[r(\"q-card-section\",{staticClass:\"row items-center\"},[r(\"span\",{staticClass:\"q-ml-sm\"},[t._v(\"Are you sure you want delete? Image of\\n            \"+t._s(t.coverToBeCleared.replace(\"_\",\" \").toUpperCase())+\" will be\\n            cleared\")])]),r(\"q-card-actions\",{attrs:{align:\"right\"}},[r(\"q-btn\",{directives:[{name:\"close-popup\",rawName:\"v-close-popup\"}],attrs:{flat:\"\",label:\"Cancel\",color:\"primary\"}}),r(\"q-btn\",{attrs:{flat:\"\",icon:\"delete\",label:\"Delete\",color:\"negative\"},on:{click:t.clearCover}})],1)],1)],1),r(\"q-dialog\",{ref:\"deleteDialog\",attrs:{persistent:\"\"},model:{value:t.confirm_untick,callback:function(e){t.confirm_untick=e},expression:\"confirm_untick\"}},[r(\"q-card\",[r(\"q-card-section\",{staticClass:\"row items-center\"},[r(\"span\",{staticClass:\"q-ml-sm\"},[t._v(\"Are you sure you want delete? All related and children data of\\n            the \"+t._s(t.difference_option_label)+\" will be lost\")])]),r(\"q-card-actions\",{attrs:{align:\"right\"}},[r(\"q-btn\",{attrs:{flat:\"\",label:\"Cancel\",color:\"primary\"},on:{click:t.cancelDelete}}),r(\"q-btn\",{attrs:{flat:\"\",icon:\"delete\",label:\"Delete\",color:\"negative\"},on:{click:t.confirmDelete}})],1)],1)],1),r(\"q-dialog\",{ref:\"publishDialog\",attrs:{persistent:\"\"},model:{value:t.confirm_publish,callback:function(e){t.confirm_publish=e},expression:\"confirm_publish\"}},[r(\"q-card\",[r(\"q-card-section\",{staticClass:\"row items-center\"},[r(\"span\",{staticClass:\"q-ml-sm\"},[t._v(\"Are you sure you want publish? The contents of the published book\\n            cannot be altered or deleted after it had been published.\")])]),r(\"q-card-actions\",{attrs:{align:\"right\"}},[r(\"q-btn\",{directives:[{name:\"close-popup\",rawName:\"v-close-popup\"}],attrs:{flat:\"\",label:\"Cancel\",color:\"primary\"}}),r(\"q-btn\",{attrs:{flat:\"\",icon:\"publish\",label:\"Publish\",color:\"positive\"},on:{click:t.confirmPublish}})],1)],1)],1)],1)])},o=[],s=(r(\"a4d3\"),r(\"e01a\"),r(\"4de4\"),r(\"caad\"),r(\"2532\"),r(\"99af\"),r(\"a434\"),r(\"fb6a\"),r(\"d3b7\"),function(){var t=this,e=t.$createElement,r=t._self._c||e;return r(\"q-file\",{staticStyle:{\"max-width\":\"300px\"},attrs:{value:t.files,label:t.$props.label,outlined:\"\",multiple:\"\",append:t.$props.multiple,accept:\".jpg, .png, .gif, image/*\",\"max-file-size\":\"10000000\",clearable:!t.isUploading},on:{input:t.updateFiles,rejected:t.onRejected},scopedSlots:t._u([{key:\"file\",fn:function(e){var i=e.index,o=e.file;return[r(\"q-chip\",{staticClass:\"full-width q-my-xs bg-grey\",attrs:{removable:t.isUploading&&t.uploadProgress[i].percent<1,square:\"\"},on:{remove:function(e){return t.cancelFile(i)}}},[r(\"q-linear-progress\",{staticClass:\"absolute-full full-height\",attrs:{value:t.uploadProgress[i].percent,color:t.uploadProgress[i].color,\"track-color\":\"grey-2\"}}),r(\"q-avatar\",[r(\"q-icon\",{attrs:{name:t.uploadProgress[i].icon}})],1),r(\"div\",{staticClass:\"ellipsis relative-position\"},[t._v(\"\\r\\n          \"+t._s(o.name)+\"\\r\\n        \")]),r(\"q-tooltip\",[t._v(\"\\r\\n          \"+t._s(o.name)+\"\\r\\n        \")])],1)]}},t.canUpload?{key:\"after\",fn:function(){return[r(\"q-btn\",{attrs:{color:\"primary\",dense:\"\",icon:\"cloud_upload\",round:\"\",disable:!t.canUpload,loading:t.isUploading},on:{click:t.upload}})]},proxy:!0}:null],null,!0)})}),a=[],n=r(\"ded3\"),c=r.n(n),l=(r(\"b0c0\"),r(\"d81d\"),{name:\"FileUploader\",props:{label:{type:String,default:\"Pick Files\"},multiple:{type:Boolean,default:!1}},data:function(){return{files:null,uploadProgress:[],uploading:null,error:!1,percent:0}},computed:{isUploading:function(){return null!==this.uploading},canUpload:function(){return null!==this.files}},methods:{onRejected:function(t){for(var e=0;e<t.length;e++){var r=t[e];this.$q.notify({type:\"negative\",message:\"\".concat(r.file.name,\" was rejected as it fails \").concat(r.failedPropValidation.replaceAll(\"-\",\" \"),\" validation\")})}},cancelFile:function(t){this.uploadProgress[t]=c()(c()({},this.uploadProgress[t]),{},{error:!0,color:\"orange-2\"})},updateFiles:function(t){this.files=t,this.uploadProgress=(t||[]).map((function(t){return{error:!1,color:\"green-2\",percent:0,icon:0===t.type.indexOf(\"video/\")?\"movie\":0===t.type.indexOf(\"image/\")?\"photo\":0===t.type.indexOf(\"audio/\")?\"audiotrack\":\"insert_drive_file\"}}))},upload:function(){var t=this;clearTimeout(this.uploading);var e={files:this.files,type:this.$props.label};this.$emit(\"upload\",e,(function(e){e?t.percent=1:t.error=!0}));var r=this.uploadProgress.every((function(t){return 1===t.percent}));this.uploadProgress=this.uploadProgress.map((function(t){return c()(c()({},t),{},{error:!1,color:\"green-2\",percent:!0===r?0:t.percent})})),this.__updateUploadProgress()},__updateUploadProgress:function(){var t=this,e=!0;this.uploadProgress=this.uploadProgress.map((function(r){if(r.percent=t.percent,1===r.percent||!0===r.error)return r;var i=Math.min(1,r.percent+Math.random()/10),o=t.error;return!1===o&&i<1&&!0===e&&(e=!1),t.percent=i,c()(c()({},r),{},{error:o,color:!0===o?\"red-2\":\"green-2\",percent:i})})),this.uploading=!0!==e?setTimeout(this.__updateUploadProgress,300):null,console.log(this.files)}},beforeDestroy:function(){clearTimeout(this.uploading)}}),p=l,u=r(\"2877\"),d=r(\"7d53\"),h=r(\"b047\"),f=r(\"6b1d\"),g=r(\"cb32\"),m=r(\"0016\"),v=r(\"05c0\"),b=r(\"9c40\"),_=r(\"eebe\"),y=r.n(_),w=Object(u[\"a\"])(p,s,a,!1,null,null,null),k=w.exports;y()(w,\"components\",{QFile:d[\"a\"],QChip:h[\"a\"],QLinearProgress:f[\"a\"],QAvatar:g[\"a\"],QIcon:m[\"a\"],QTooltip:v[\"a\"],QBtn:b[\"a\"]});var $={name:\"ManuscriptPage\",components:{FileUploader:k},data:function(){return{title:this.$store.getters[\"write/manuscriptProperty\"](\"title\"),description:this.$store.getters[\"write/manuscriptProperty\"](\"description\"),frontCover:this.$store.getters[\"write/manuscriptProperty\"](\"front_cover\"),backCover:this.$store.getters[\"write/manuscriptProperty\"](\"back_cover\"),options:[{label:\"Contain Characters\",body:\"contain_character\"},{label:\"Contain Front Matter\",body:\"contain_front_matter\"},{label:\"Contain Chapters\",body:\"contain_chapter\"},{label:\"Contain Back Matter\",body:\"contain_back_matter\"},{label:\"Automatically add titles as h2 tags\",body:\"auto_add_title\"}],configs:this.$store.getters[\"write/manuscriptProperty\"](\"configs\"),ticked:this.$store.getters[\"write/getConfigs\"],selectedOptions:this.$store.getters[\"write/getConfigs\"],loading:!1,difference_option:\"\",difference_option_label:\"\",confirm_untick:!1,confirm_publish:!1,clear_cover:!1,coverToBeCleared:\"\"}},methods:{editTitle:function(){var t=this;this.$store.getters[\"write/isLoading\"]||this.$store.dispatch(\"write/editManuscript\",{title:this.title}).then((function(t){})).catch((function(e){t.$q.notify({color:\"negative\",position:\"top\",message:e.response.data.message||\"Something went wrong\",icon:\"error\"})}))},editDescription:function(){var t=this;this.$store.getters[\"write/isLoading\"]||this.$store.dispatch(\"write/editManuscript\",{description:this.description}).then((function(t){})).catch((function(e){t.$q.notify({color:\"negative\",position:\"top\",message:e.response.data.message||\"Something went wrong\",icon:\"error\"})}))},clearCover:function(){var t=this;if(!this.$store.getters[\"write/isLoading\"]){var e={};e[this.coverToBeCleared]=\"\",this.$store.dispatch(\"write/editManuscript\",e).then((function(t){})).catch((function(e){t.$q.notify({color:\"negative\",position:\"top\",message:e.response.data.message||\"Something went wrong\",icon:\"error\"})})),this.clear_cover=!1}},handleTicked:function(t){var e=this,r=this.selectedOptions.filter((function(t){return!e.ticked.includes(t)}));0!=r.length&&(this.difference_option=r[0],this.difference_option_label=this.$refs.optionsTree.getNodeByKey(this.difference_option)[\"label\"],this.confirm_untick=!0);var i=this.ticked.filter((function(t){return!e.selectedOptions.includes(t)}));if(0!=i.length){this.selectedOptions.push(o);var o=i[0];this.configs[o]=!0,this.$store.dispatch(\"write/editConfigs\",this.configs).then((function(t){})).catch((function(t){e.$q.notify({color:\"negative\",position:\"top\",message:t.response.data.message||\"Something went wrong\",icon:\"error\"})}))}},handleUpload:function(t,e){var r=this;if(!this.$store.state.write.loading){var i=new FormData,o=t.files[0],s=t.type,a=s.toLowerCase().replaceAll(\" \",\"_\"),n=\"BookKay/\".concat(s,\"/\").concat(a,\"_\").concat(this.$store.getters[\"write/manuscriptProperty\"](\"id\"));i.append(\"file\",o,n),this.$store.dispatch(\"write/uploadMedia\",i).then((function(t){var i=t.data.secure_url;e(!0);var o={};o[a]=i,r.$store.dispatch(\"write/editManuscript\",o).then((function(t){})).catch((function(t){r.$q.notify({color:\"negative\",position:\"top\",message:t.response.data.message||\"Something went wrong\",icon:\"error\"})}))})).catch((function(t){e(!1);var i=\"\";try{i=t.response.data.message}catch(o){i=\"Something went wrong. Please try refreshing the page\"}r.$q.notify({color:\"negative\",position:\"top\",message:i,icon:\"error\"})}))}},confirmDelete:function(){var t=this,e=this.selectedOptions.indexOf(this.difference_option);e>-1&&this.selectedOptions.splice(e,1),this.confirm_untick=!1;var r=this.difference_option;this.configs[r]=!1,this.$store.dispatch(\"write/editConfigs\",this.configs).then((function(i){var o=\"\";switch(r){case\"contain_character\":o=\"characters\";break;case\"contain_chapter\":o=\"chapters\";break;case\"contain_front_matter\":o=\"front_matters\";break;case\"contain_back_matter\":o=\"back_matters\";break;default:}var s=t.$store.getters[\"write/manuscriptProperty\"](o);if(\"\"!=o)for(var a=0;a<s.length;a++){var n=s[a],c={id:n.id,type:o.slice(0,-1)};t.$store.dispatch(\"write/deleteChapter\",c).then((function(t){})).catch((function(r){t.$q.notify({color:\"negative\",position:\"top\",message:r.response.data.message||\"Something went wrong\",icon:\"error\"}),t.chapters.splice(e,0,chapter)}))}})).catch((function(e){t.$q.notify({color:\"negative\",position:\"top\",message:e.response.data.message||\"Something went wrong\",icon:\"error\"})}))},cancelDelete:function(){this.ticked.push(this.difference_option),this.confirm_untick=!1},confirmPublish:function(){var t=[];if(this.$store.getters[\"write/manuscriptProperty\"](\"title\")||t.push(\"title\"),this.$store.getters[\"write/manuscriptProperty\"](\"description\")||t.push(\"description\"),this.$store.getters[\"write/manuscriptProperty\"](\"front_cover\")||t.push(\"front_cover\"),this.$store.getters[\"write/manuscriptProperty\"](\"back_cover\")||t.push(\"back_cover\"),this.$store.getters[\"write/manuscriptProperty\"](\"title\")&&this.$store.getters[\"write/manuscriptProperty\"](\"description\")&&this.$store.getters[\"write/manuscriptProperty\"](\"front_cover\")&&this.$store.getters[\"write/manuscriptProperty\"](\"back_cover\"))this.loading=!0,this.publish();else{var e=\"Please fill in these information to publish - \"+t.toString();this.$q.notify({type:\"negative\",message:e})}this.confirm_publish=!1},publish:function(){var t=this,e={title:this.$store.getters[\"write/manuscriptProperty\"](\"title\"),description:this.$store.getters[\"write/manuscriptProperty\"](\"description\"),front_cover:this.$store.getters[\"write/manuscriptProperty\"](\"front_cover\"),back_cover:this.$store.getters[\"write/manuscriptProperty\"](\"back_cover\"),author_id:this.$store.getters[\"write/manuscriptProperty\"](\"author\").id,price:0,text:this.$store.getters[\"write/manuscriptProperty\"](\"text\"),publish_date:(new Date).toISOString,contain_character:this.$store.getters[\"write/manuscriptProperty\"](\"configs\").contain_character,contain_front_matter:this.$store.getters[\"write/manuscriptProperty\"](\"configs\").contain_front_matter,contain_chapter:this.$store.getters[\"write/manuscriptProperty\"](\"configs\").contain_chapter,contain_back_matter:this.$store.getters[\"write/manuscriptProperty\"](\"configs\").contain_back_matter,auto_add_title:this.$store.getters[\"write/manuscriptProperty\"](\"configs\").auto_add_title};this.$store.dispatch(\"write/publishBook\",e).then((function(e){console.log(\"data\",e);var r=e.data.book.id;t.assembleBook(r),t.loading=!1,t.$q.notify({color:\"positive\",position:\"top\",message:\"Yay! Your book has been published successfully on our bookstore\",icon:\"error\"}),t.$router.push({name:\"app-read\"})})).catch((function(e){console.log(e);var r=\"\";try{r=e.response.data.message}catch(i){r=\"Something went wrong. Please try refreshing the page\"}t.$q.notify({color:\"negative\",position:\"top\",message:r,icon:\"error\"}),t.loading=!1}))},assembleBook:function(t){if(this.$store.getters[\"write/manuscriptProperty\"](\"configs\").contain_character)for(var e=this.$store.getters[\"write/manuscriptProperty\"](\"characters\"),r=0;r<e.length;r++){var i=e[r];i.book_id=t,this.postChapter(i,\"characters\")}if(this.$store.getters[\"write/manuscriptProperty\"](\"configs\").contain_front_matter){var o=this.$store.getters[\"write/manuscriptProperty\"](\"front_matters\");for(r=0;r<o.length;r++){var s=o[r];s.book_id=t,this.postChapter(s,\"Front Matter\")}}if(this.$store.getters[\"write/manuscriptProperty\"](\"configs\").contain_chapter){var a=this.$store.getters[\"write/manuscriptProperty\"](\"chapters\");for(r=0;r<a.length;r++){var n=a[r];n.book_id=t,this.postChapter(n,\"Chapter\")}}if(this.$store.getters[\"write/manuscriptProperty\"](\"configs\").contain_back_matter){var c=this.$store.getters[\"write/manuscriptProperty\"](\"back_matters\");for(r=0;r<c.length;r++){var l=c[r];l.book_id=t,this.postChapter(l,\"Back Matter\")}}},postChapter:function(t,e){var r=this,i={chapter:t,type:e,isBook:!0};this.$store.dispatch(\"write/addChapter\",i).then((function(t){})).catch((function(t){r.$q.notify({color:\"negative\",position:\"top\",message:t.response.data.message||\"Something went wrong\",icon:\"error\"})}))},onRejected:function(t){this.$q.notify({type:\"negative\",message:\"\".concat(t.length,\" file(s) did not pass validation constraints\")})}}},P=$,C=r(\"9989\"),q=r(\"eb85\"),x=r(\"27f9\"),S=r(\"7f41\"),T=r(\"9149\"),B=r(\"24e8\"),D=r(\"f09f\"),Q=r(\"a370\"),U=r(\"4b7e\"),F=r(\"7f67\"),M=Object(u[\"a\"])(P,i,o,!1,null,null,null);e[\"default\"]=M.exports;y()(M,\"components\",{QPage:C[\"a\"],QSeparator:q[\"a\"],QInput:x[\"a\"],QBtn:b[\"a\"],QTree:S[\"a\"],QSpinnerHourglass:T[\"a\"],QDialog:B[\"a\"],QCard:D[\"a\"],QCardSection:Q[\"a\"],QCardActions:U[\"a\"]}),y()(M,\"directives\",{ClosePopup:F[\"a\"]})}}]);","name":"js/22.1c61d616.js","input":"(window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || []).push([[22],{\n\n/***/ \"a119\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n// ESM COMPAT FLAG\n__webpack_require__.r(__webpack_exports__);\n\n// CONCATENATED MODULE: ./node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/@quasar/app/lib/webpack/loader.auto-import-client.js?kebab!./node_modules/vue-loader/lib??vue-loader-options!./src/pages/write/ConfigPage.vue?vue&type=template&id=c500d078&\nvar render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('q-page',{staticClass:\"flex\"},[_c('div',{staticClass:\"col\"},[_c('div',{staticClass:\"row q-ml-lg\"},[_c('h2',{staticClass:\"q-mb-sm\"},[_vm._v(\"Manuscript Configs\")])]),_c('q-separator',{attrs:{\"inset\":\"\"}}),_c('div',{staticClass:\"row-12 q-ma-lg\"},[_c('q-input',{ref:\"titleInput\",staticStyle:{\"font-size\":\"1rem\"},attrs:{\"label\":\"Title:\",\"label-color\":\"primary\",\"filled\":\"\",\"rules\":[\n          function (val) { return (val !== null && val !== '') || 'Please type the title'; },\n          function (val) { return val.length <= 100 || 'Title must be smaller than 100'; }\n        ]},on:{\"input\":_vm.editTitle,\"blur\":_vm.editTitle},model:{value:(_vm.title),callback:function ($$v) {_vm.title=$$v},expression:\"title\"}})],1),_c('div',{staticClass:\"row-12 q-mx-lg\"},[_c('q-input',{ref:\"descriptionInput\",staticStyle:{\"font-size\":\"1rem\"},attrs:{\"label\":\"Description:\",\"label-color\":\"primary\",\"filled\":\"\",\"rules\":[ true || false],\"autogrow\":\"\"},on:{\"input\":_vm.editDescription,\"blur\":_vm.editDescription},model:{value:(_vm.description),callback:function ($$v) {_vm.description=$$v},expression:\"description\"}})],1),(!_vm.$store.getters['write/manuscriptProperty']('front_cover'))?_c('file-uploader',{staticClass:\"q-ma-lg\",attrs:{\"label\":\"Front Cover\"},on:{\"upload\":_vm.handleUpload}}):_c('q-btn',{staticClass:\"q-ma-lg\",attrs:{\"outline\":\"\",\"color\":\"positive\",\"label\":\"Front Cover\",\"icon\":\"check_circle\"},on:{\"click\":function($event){_vm.clear_cover = true;\n        _vm.coverToBeCleared = 'front_cover';}}}),(!_vm.$store.getters['write/manuscriptProperty']('back_cover'))?_c('file-uploader',{staticClass:\"q-ma-lg\",attrs:{\"label\":\"Back Cover\"},on:{\"upload\":_vm.handleUpload}}):_c('q-btn',{staticClass:\"q-ma-lg\",attrs:{\"outline\":\"\",\"color\":\"positive\",\"label\":\"Back Cover\",\"icon\":\"check_circle\"},on:{\"click\":function($event){_vm.clear_cover = true;\n        _vm.coverToBeCleared = 'back_cover';}}}),_c('div',{staticClass:\"row-12 q-ma-md\"},[_c('q-tree',{ref:\"optionsTree\",staticClass:\"col-12 col-sm-6\",attrs:{\"nodes\":_vm.options,\"node-key\":\"body\",\"tick-strategy\":\"strict\",\"ticked\":_vm.ticked},on:{\"update:ticked\":[function($event){_vm.ticked=$event},_vm.handleTicked]}})],1),_c('div',[_c('q-btn',{staticClass:\"q-ma-md\",attrs:{\"color\":\"primary\",\"label\":\"Publish\",\"size\":\"large\"},on:{\"click\":function($event){_vm.confirm_publish = true}}},[(_vm.loading)?_c('q-spinner-hourglass',{attrs:{\"color\":\"white\",\"size\":\"1.2em\"}}):_vm._e()],1)],1),_c('q-dialog',{ref:\"clearCoverDialog\",model:{value:(_vm.clear_cover),callback:function ($$v) {_vm.clear_cover=$$v},expression:\"clear_cover\"}},[_c('q-card',[_c('q-card-section',{staticClass:\"row items-center\"},[_c('span',{staticClass:\"q-ml-sm\"},[_vm._v(\"Are you sure you want delete? Image of\\n            \"+_vm._s(_vm.coverToBeCleared.replace(\"_\", \" \").toUpperCase())+\" will be\\n            cleared\")])]),_c('q-card-actions',{attrs:{\"align\":\"right\"}},[_c('q-btn',{directives:[{name:\"close-popup\",rawName:\"v-close-popup\"}],attrs:{\"flat\":\"\",\"label\":\"Cancel\",\"color\":\"primary\"}}),_c('q-btn',{attrs:{\"flat\":\"\",\"icon\":\"delete\",\"label\":\"Delete\",\"color\":\"negative\"},on:{\"click\":_vm.clearCover}})],1)],1)],1),_c('q-dialog',{ref:\"deleteDialog\",attrs:{\"persistent\":\"\"},model:{value:(_vm.confirm_untick),callback:function ($$v) {_vm.confirm_untick=$$v},expression:\"confirm_untick\"}},[_c('q-card',[_c('q-card-section',{staticClass:\"row items-center\"},[_c('span',{staticClass:\"q-ml-sm\"},[_vm._v(\"Are you sure you want delete? All related and children data of\\n            the \"+_vm._s(_vm.difference_option_label)+\" will be lost\")])]),_c('q-card-actions',{attrs:{\"align\":\"right\"}},[_c('q-btn',{attrs:{\"flat\":\"\",\"label\":\"Cancel\",\"color\":\"primary\"},on:{\"click\":_vm.cancelDelete}}),_c('q-btn',{attrs:{\"flat\":\"\",\"icon\":\"delete\",\"label\":\"Delete\",\"color\":\"negative\"},on:{\"click\":_vm.confirmDelete}})],1)],1)],1),_c('q-dialog',{ref:\"publishDialog\",attrs:{\"persistent\":\"\"},model:{value:(_vm.confirm_publish),callback:function ($$v) {_vm.confirm_publish=$$v},expression:\"confirm_publish\"}},[_c('q-card',[_c('q-card-section',{staticClass:\"row items-center\"},[_c('span',{staticClass:\"q-ml-sm\"},[_vm._v(\"Are you sure you want publish? The contents of the published book\\n            cannot be altered or deleted after it had been published.\")])]),_c('q-card-actions',{attrs:{\"align\":\"right\"}},[_c('q-btn',{directives:[{name:\"close-popup\",rawName:\"v-close-popup\"}],attrs:{\"flat\":\"\",\"label\":\"Cancel\",\"color\":\"primary\"}}),_c('q-btn',{attrs:{\"flat\":\"\",\"icon\":\"publish\",\"label\":\"Publish\",\"color\":\"positive\"},on:{\"click\":_vm.confirmPublish}})],1)],1)],1)],1)])}\nvar staticRenderFns = []\n\n\n// CONCATENATED MODULE: ./src/pages/write/ConfigPage.vue?vue&type=template&id=c500d078&\n\n// EXTERNAL MODULE: ./node_modules/core-js/modules/es.symbol.js\nvar es_symbol = __webpack_require__(\"a4d3\");\n\n// EXTERNAL MODULE: ./node_modules/core-js/modules/es.symbol.description.js\nvar es_symbol_description = __webpack_require__(\"e01a\");\n\n// EXTERNAL MODULE: ./node_modules/core-js/modules/es.array.filter.js\nvar es_array_filter = __webpack_require__(\"4de4\");\n\n// EXTERNAL MODULE: ./node_modules/core-js/modules/es.array.includes.js\nvar es_array_includes = __webpack_require__(\"caad\");\n\n// EXTERNAL MODULE: ./node_modules/core-js/modules/es.string.includes.js\nvar es_string_includes = __webpack_require__(\"2532\");\n\n// EXTERNAL MODULE: ./node_modules/core-js/modules/es.array.concat.js\nvar es_array_concat = __webpack_require__(\"99af\");\n\n// EXTERNAL MODULE: ./node_modules/core-js/modules/es.array.splice.js\nvar es_array_splice = __webpack_require__(\"a434\");\n\n// EXTERNAL MODULE: ./node_modules/core-js/modules/es.array.slice.js\nvar es_array_slice = __webpack_require__(\"fb6a\");\n\n// EXTERNAL MODULE: ./node_modules/core-js/modules/es.object.to-string.js\nvar es_object_to_string = __webpack_require__(\"d3b7\");\n\n// CONCATENATED MODULE: ./node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/@quasar/app/lib/webpack/loader.auto-import-client.js?kebab!./node_modules/vue-loader/lib??vue-loader-options!./src/components/helpers/FileUploader.vue?vue&type=template&id=11f0848b&\nvar FileUploadervue_type_template_id_11f0848b_render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('q-file',{staticStyle:{\"max-width\":\"300px\"},attrs:{\"value\":_vm.files,\"label\":_vm.$props.label,\"outlined\":\"\",\"multiple\":\"\",\"append\":_vm.$props.multiple,\"accept\":\".jpg, .png, .gif, image/*\",\"max-file-size\":\"10000000\",\"clearable\":!_vm.isUploading},on:{\"input\":_vm.updateFiles,\"rejected\":_vm.onRejected},scopedSlots:_vm._u([{key:\"file\",fn:function(ref){\nvar index = ref.index;\nvar file = ref.file;\nreturn [_c('q-chip',{staticClass:\"full-width q-my-xs bg-grey\",attrs:{\"removable\":_vm.isUploading && _vm.uploadProgress[index].percent < 1,\"square\":\"\"},on:{\"remove\":function($event){return _vm.cancelFile(index)}}},[_c('q-linear-progress',{staticClass:\"absolute-full full-height\",attrs:{\"value\":_vm.uploadProgress[index].percent,\"color\":_vm.uploadProgress[index].color,\"track-color\":\"grey-2\"}}),_c('q-avatar',[_c('q-icon',{attrs:{\"name\":_vm.uploadProgress[index].icon}})],1),_c('div',{staticClass:\"ellipsis relative-position\"},[_vm._v(\"\\r\\n          \"+_vm._s(file.name)+\"\\r\\n        \")]),_c('q-tooltip',[_vm._v(\"\\r\\n          \"+_vm._s(file.name)+\"\\r\\n        \")])],1)]}},(_vm.canUpload)?{key:\"after\",fn:function(){return [_c('q-btn',{attrs:{\"color\":\"primary\",\"dense\":\"\",\"icon\":\"cloud_upload\",\"round\":\"\",\"disable\":!_vm.canUpload,\"loading\":_vm.isUploading},on:{\"click\":_vm.upload}})]},proxy:true}:null],null,true)})}\nvar FileUploadervue_type_template_id_11f0848b_staticRenderFns = []\n\n\n// CONCATENATED MODULE: ./src/components/helpers/FileUploader.vue?vue&type=template&id=11f0848b&\n\n// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/objectSpread2.js\nvar objectSpread2 = __webpack_require__(\"ded3\");\nvar objectSpread2_default = /*#__PURE__*/__webpack_require__.n(objectSpread2);\n\n// EXTERNAL MODULE: ./node_modules/core-js/modules/es.function.name.js\nvar es_function_name = __webpack_require__(\"b0c0\");\n\n// EXTERNAL MODULE: ./node_modules/core-js/modules/es.array.map.js\nvar es_array_map = __webpack_require__(\"d81d\");\n\n// CONCATENATED MODULE: ./node_modules/@quasar/app/lib/webpack/loader.transform-quasar-imports.js!./node_modules/babel-loader/lib??ref--2-0!./node_modules/@quasar/app/lib/webpack/loader.auto-import-client.js?kebab!./node_modules/vue-loader/lib??vue-loader-options!./src/components/helpers/FileUploader.vue?vue&type=script&lang=js&\n\n\n\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n/* harmony default export */ var FileUploadervue_type_script_lang_js_ = ({\n  name: \"FileUploader\",\n  props: {\n    label: {\n      type: String,\n      default: \"Pick Files\"\n    },\n    multiple: {\n      type: Boolean,\n      default: false\n    }\n  },\n  data: function data() {\n    return {\n      files: null,\n      uploadProgress: [],\n      uploading: null,\n      error: false,\n      percent: 0\n    };\n  },\n  computed: {\n    isUploading: function isUploading() {\n      return this.uploading !== null;\n    },\n    canUpload: function canUpload() {\n      return this.files !== null;\n    }\n  },\n  methods: {\n    onRejected: function onRejected(rejectedEntries) {\n      for (var i = 0; i < rejectedEntries.length; i++) {\n        var entry = rejectedEntries[i];\n        this.$q.notify({\n          type: \"negative\",\n          message: \"\".concat(entry.file.name, \" was rejected as it fails \").concat(entry.failedPropValidation.replaceAll(\"-\", \" \"), \" validation\")\n        });\n      }\n    },\n    cancelFile: function cancelFile(index) {\n      this.uploadProgress[index] = objectSpread2_default()(objectSpread2_default()({}, this.uploadProgress[index]), {}, {\n        error: true,\n        color: \"orange-2\"\n      });\n    },\n    updateFiles: function updateFiles(files) {\n      this.files = files;\n      this.uploadProgress = (files || []).map(function (file) {\n        return {\n          error: false,\n          color: \"green-2\",\n          percent: 0,\n          icon: file.type.indexOf(\"video/\") === 0 ? \"movie\" : file.type.indexOf(\"image/\") === 0 ? \"photo\" : file.type.indexOf(\"audio/\") === 0 ? \"audiotrack\" : \"insert_drive_file\"\n        };\n      });\n    },\n    upload: function upload() {\n      var _this = this;\n\n      clearTimeout(this.uploading);\n      var payload = {\n        files: this.files,\n        type: this.$props.label\n      };\n      this.$emit(\"upload\", payload, function (val) {\n        if (val) {\n          _this.percent = 1;\n        } else {\n          _this.error = true;\n        }\n      });\n      var allDone = this.uploadProgress.every(function (progress) {\n        return progress.percent === 1;\n      });\n      this.uploadProgress = this.uploadProgress.map(function (progress) {\n        return objectSpread2_default()(objectSpread2_default()({}, progress), {}, {\n          error: false,\n          color: \"green-2\",\n          percent: allDone === true ? 0 : progress.percent\n        });\n      });\n\n      this.__updateUploadProgress();\n    },\n    __updateUploadProgress: function __updateUploadProgress() {\n      var _this2 = this;\n\n      var done = true;\n      this.uploadProgress = this.uploadProgress.map(function (progress) {\n        progress.percent = _this2.percent;\n\n        if (progress.percent === 1 || progress.error === true) {\n          return progress;\n        }\n\n        var percent = Math.min(1, progress.percent + Math.random() / 10);\n        var error = _this2.error;\n\n        if (error === false && percent < 1 && done === true) {\n          done = false;\n        }\n\n        _this2.percent = percent;\n        return objectSpread2_default()(objectSpread2_default()({}, progress), {}, {\n          error: error,\n          color: error === true ? \"red-2\" : \"green-2\",\n          percent: percent\n        });\n      });\n      this.uploading = done !== true ? setTimeout(this.__updateUploadProgress, 300) : null;\n      console.log(this.files);\n    }\n  },\n  beforeDestroy: function beforeDestroy() {\n    clearTimeout(this.uploading);\n  }\n});\n// CONCATENATED MODULE: ./src/components/helpers/FileUploader.vue?vue&type=script&lang=js&\n /* harmony default export */ var helpers_FileUploadervue_type_script_lang_js_ = (FileUploadervue_type_script_lang_js_); \n// EXTERNAL MODULE: ./node_modules/vue-loader/lib/runtime/componentNormalizer.js\nvar componentNormalizer = __webpack_require__(\"2877\");\n\n// EXTERNAL MODULE: ./node_modules/quasar/src/components/file/QFile.js\nvar QFile = __webpack_require__(\"7d53\");\n\n// EXTERNAL MODULE: ./node_modules/quasar/src/components/chip/QChip.js\nvar QChip = __webpack_require__(\"b047\");\n\n// EXTERNAL MODULE: ./node_modules/quasar/src/components/linear-progress/QLinearProgress.js\nvar QLinearProgress = __webpack_require__(\"6b1d\");\n\n// EXTERNAL MODULE: ./node_modules/quasar/src/components/avatar/QAvatar.js\nvar QAvatar = __webpack_require__(\"cb32\");\n\n// EXTERNAL MODULE: ./node_modules/quasar/src/components/icon/QIcon.js\nvar QIcon = __webpack_require__(\"0016\");\n\n// EXTERNAL MODULE: ./node_modules/quasar/src/components/tooltip/QTooltip.js\nvar QTooltip = __webpack_require__(\"05c0\");\n\n// EXTERNAL MODULE: ./node_modules/quasar/src/components/btn/QBtn.js\nvar QBtn = __webpack_require__(\"9c40\");\n\n// EXTERNAL MODULE: ./node_modules/@quasar/app/lib/webpack/runtime.auto-import.js\nvar runtime_auto_import = __webpack_require__(\"eebe\");\nvar runtime_auto_import_default = /*#__PURE__*/__webpack_require__.n(runtime_auto_import);\n\n// CONCATENATED MODULE: ./src/components/helpers/FileUploader.vue\n\n\n\n\n\n/* normalize component */\n\nvar component = Object(componentNormalizer[\"a\" /* default */])(\n  helpers_FileUploadervue_type_script_lang_js_,\n  FileUploadervue_type_template_id_11f0848b_render,\n  FileUploadervue_type_template_id_11f0848b_staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* harmony default export */ var FileUploader = (component.exports);\n\n\n\n\n\n\n\n\nruntime_auto_import_default()(component, 'components', {QFile: QFile[\"a\" /* default */],QChip: QChip[\"a\" /* default */],QLinearProgress: QLinearProgress[\"a\" /* default */],QAvatar: QAvatar[\"a\" /* default */],QIcon: QIcon[\"a\" /* default */],QTooltip: QTooltip[\"a\" /* default */],QBtn: QBtn[\"a\" /* default */]});\n\n// CONCATENATED MODULE: ./node_modules/@quasar/app/lib/webpack/loader.transform-quasar-imports.js!./node_modules/babel-loader/lib??ref--2-0!./node_modules/@quasar/app/lib/webpack/loader.auto-import-client.js?kebab!./node_modules/vue-loader/lib??vue-loader-options!./src/pages/write/ConfigPage.vue?vue&type=script&lang=js&\n\n\n\n\n\n\n\n\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n/* harmony default export */ var ConfigPagevue_type_script_lang_js_ = ({\n  name: \"ManuscriptPage\",\n  components: {\n    FileUploader: FileUploader\n  },\n  data: function data() {\n    return {\n      title: this.$store.getters[\"write/manuscriptProperty\"](\"title\"),\n      description: this.$store.getters[\"write/manuscriptProperty\"](\"description\"),\n      frontCover: this.$store.getters[\"write/manuscriptProperty\"](\"front_cover\"),\n      backCover: this.$store.getters[\"write/manuscriptProperty\"](\"back_cover\"),\n      options: [{\n        label: \"Contain Characters\",\n        body: \"contain_character\"\n      }, {\n        label: \"Contain Front Matter\",\n        body: \"contain_front_matter\"\n      }, {\n        label: \"Contain Chapters\",\n        body: \"contain_chapter\"\n      }, {\n        label: \"Contain Back Matter\",\n        body: \"contain_back_matter\"\n      }, {\n        label: \"Automatically add titles as h2 tags\",\n        body: \"auto_add_title\"\n      }],\n      configs: this.$store.getters[\"write/manuscriptProperty\"](\"configs\"),\n      ticked: this.$store.getters[\"write/getConfigs\"],\n      selectedOptions: this.$store.getters[\"write/getConfigs\"],\n      loading: false,\n      difference_option: \"\",\n      difference_option_label: \"\",\n      confirm_untick: false,\n      confirm_publish: false,\n      clear_cover: false,\n      coverToBeCleared: \"\"\n    };\n  },\n  methods: {\n    editTitle: function editTitle() {\n      var _this = this;\n\n      if (!this.$store.getters[\"write/isLoading\"]) {\n        this.$store.dispatch(\"write/editManuscript\", {\n          title: this.title\n        }\n        /*, { root: true }*/\n        ).then(function (data) {}).catch(function (error) {\n          _this.$q.notify({\n            color: \"negative\",\n            position: \"top\",\n            message: error.response.data.message || \"Something went wrong\",\n            icon: \"error\"\n          });\n        });\n      }\n    },\n    editDescription: function editDescription() {\n      var _this2 = this;\n\n      if (!this.$store.getters[\"write/isLoading\"]) {\n        this.$store.dispatch(\"write/editManuscript\", {\n          description: this.description\n        }\n        /*, { root: true }*/\n        ).then(function (data) {}).catch(function (error) {\n          _this2.$q.notify({\n            color: \"negative\",\n            position: \"top\",\n            message: error.response.data.message || \"Something went wrong\",\n            icon: \"error\"\n          });\n        });\n      }\n    },\n    clearCover: function clearCover() {\n      var _this3 = this;\n\n      //function to clear the front cover or back cover\n      if (!this.$store.getters[\"write/isLoading\"]) {\n        var payload = {};\n        payload[this.coverToBeCleared] = \"\";\n        this.$store.dispatch(\"write/editManuscript\", payload\n        /*, { root: true }*/\n        ).then(function (data) {}).catch(function (error) {\n          _this3.$q.notify({\n            color: \"negative\",\n            position: \"top\",\n            message: error.response.data.message || \"Something went wrong\",\n            icon: \"error\"\n          });\n        });\n        this.clear_cover = false;\n      }\n    },\n    handleTicked: function handleTicked(target) {\n      var _this4 = this;\n\n      //For unticking\n      var untickDifference = this.selectedOptions.filter(function (x) {\n        return !_this4.ticked.includes(x);\n      });\n\n      if (untickDifference.length != 0) {\n        this.difference_option = untickDifference[0];\n        this.difference_option_label = this.$refs.optionsTree.getNodeByKey(this.difference_option)[\"label\"];\n        this.confirm_untick = true;\n      } //For ticking\n\n\n      var tickDifference = this.ticked.filter(function (x) {\n        return !_this4.selectedOptions.includes(x);\n      });\n\n      if (tickDifference.length != 0) {\n        this.selectedOptions.push(config);\n        var config = tickDifference[0];\n        this.configs[config] = true;\n        this.$store.dispatch(\"write/editConfigs\", this.configs\n        /*, { root: true }*/\n        ).then(function (data) {}).catch(function (error) {\n          _this4.$q.notify({\n            color: \"negative\",\n            position: \"top\",\n            message: error.response.data.message || \"Something went wrong\",\n            icon: \"error\"\n          });\n        });\n      }\n    },\n    handleUpload: function handleUpload(payload, callback) {\n      var _this5 = this;\n\n      //Uploading image to cloudinary\n      if (!this.$store.state.write.loading) {\n        var formData = new FormData();\n        var file = payload.files[0];\n        var folder = payload.type;\n        var type = folder.toLowerCase().replaceAll(\" \", \"_\"); //public_id to determine which folder to upload to\n\n        var public_id = \"BookKay/\".concat(folder, \"/\").concat(type, \"_\").concat(this.$store.getters[\"write/manuscriptProperty\"](\"id\"));\n        formData.append(\"file\", file, public_id); //Firstly uploading the image to cloudinary through the back end\n        //Then, sending over the url to be saved in manuscript\n\n        this.$store.dispatch(\"write/uploadMedia\", formData\n        /*, { root: true }*/\n        ).then(function (data) {\n          var url = data.data.secure_url;\n          callback(true);\n          var cover = {};\n          cover[type] = url;\n\n          _this5.$store.dispatch(\"write/editManuscript\", cover\n          /*, { root: true }*/\n          ).then(function (data) {}).catch(function (error) {\n            _this5.$q.notify({\n              color: \"negative\",\n              position: \"top\",\n              message: error.response.data.message || \"Something went wrong\",\n              icon: \"error\"\n            });\n          });\n        }).catch(function (error) {\n          callback(false);\n          var msg = \"\";\n\n          try {\n            msg = error.response.data.message;\n          } catch (_unused) {\n            msg = \"Something went wrong. Please try refreshing the page\";\n          }\n\n          _this5.$q.notify({\n            color: \"negative\",\n            position: \"top\",\n            message: msg,\n            icon: \"error\"\n          });\n        });\n      }\n    },\n    confirmDelete: function confirmDelete() {\n      var _this6 = this;\n\n      var index = this.selectedOptions.indexOf(this.difference_option);\n\n      if (index > -1) {\n        this.selectedOptions.splice(index, 1);\n      }\n\n      this.confirm_untick = false;\n      var config = this.difference_option;\n      this.configs[config] = false;\n      this.$store.dispatch(\"write/editConfigs\", this.configs\n      /*, { root: true }*/\n      ).then(function (data) {\n        var type = \"\"; //Convert config wording to manuscript object keys format for looping\n\n        switch (config) {\n          case \"contain_character\":\n            type = \"characters\";\n            break;\n\n          case \"contain_chapter\":\n            type = \"chapters\";\n            break;\n\n          case \"contain_front_matter\":\n            type = \"front_matters\";\n            break;\n\n          case \"contain_back_matter\":\n            type = \"back_matters\";\n            break;\n\n          default:\n        }\n\n        var chaps = _this6.$store.getters[\"write/manuscriptProperty\"](type);\n\n        if (type != \"\") {\n          for (var i = 0; i < chaps.length; i++) {\n            var chap = chaps[i];\n            var payload = {\n              id: chap.id,\n              type: type.slice(0, -1) //removing 's' as it will be put in actions.js\n\n            };\n\n            _this6.$store.dispatch(\"write/deleteChapter\", payload).then(function (data) {}).catch(function (error) {\n              _this6.$q.notify({\n                color: \"negative\",\n                position: \"top\",\n                message: error.response.data.message || \"Something went wrong\",\n                icon: \"error\"\n              });\n\n              _this6.chapters.splice(index, 0, chapter);\n            });\n          }\n        }\n      }).catch(function (error) {\n        _this6.$q.notify({\n          color: \"negative\",\n          position: \"top\",\n          message: error.response.data.message || \"Something went wrong\",\n          icon: \"error\"\n        });\n      });\n    },\n    cancelDelete: function cancelDelete() {\n      this.ticked.push(this.difference_option);\n      this.confirm_untick = false;\n    },\n    confirmPublish: function confirmPublish() {\n      //checking if the book has all essential info for publishing\n      var err = [];\n\n      if (!this.$store.getters[\"write/manuscriptProperty\"](\"title\")) {\n        err.push(\"title\");\n      }\n\n      if (!this.$store.getters[\"write/manuscriptProperty\"](\"description\")) {\n        err.push(\"description\");\n      }\n\n      if (!this.$store.getters[\"write/manuscriptProperty\"](\"front_cover\")) {\n        err.push(\"front_cover\");\n      }\n\n      if (!this.$store.getters[\"write/manuscriptProperty\"](\"back_cover\")) {\n        err.push(\"back_cover\");\n      }\n\n      if (this.$store.getters[\"write/manuscriptProperty\"](\"title\") && this.$store.getters[\"write/manuscriptProperty\"](\"description\") && this.$store.getters[\"write/manuscriptProperty\"](\"front_cover\") && this.$store.getters[\"write/manuscriptProperty\"](\"back_cover\")) {\n        this.loading = true;\n        this.publish();\n      } else {\n        var msg = \"Please fill in these information to publish - \" + err.toString();\n        this.$q.notify({\n          type: \"negative\",\n          message: msg\n        });\n      }\n\n      this.confirm_publish = false;\n    },\n    publish: function publish() {\n      var _this7 = this;\n\n      //Function to publish the book\n      var book = {\n        title: this.$store.getters[\"write/manuscriptProperty\"](\"title\"),\n        description: this.$store.getters[\"write/manuscriptProperty\"](\"description\"),\n        front_cover: this.$store.getters[\"write/manuscriptProperty\"](\"front_cover\"),\n        back_cover: this.$store.getters[\"write/manuscriptProperty\"](\"back_cover\"),\n        author_id: this.$store.getters[\"write/manuscriptProperty\"](\"author\").id,\n        price: 0,\n        text: this.$store.getters[\"write/manuscriptProperty\"](\"text\"),\n        publish_date: new Date().toISOString,\n        contain_character: this.$store.getters[\"write/manuscriptProperty\"](\"configs\").contain_character,\n        contain_front_matter: this.$store.getters[\"write/manuscriptProperty\"](\"configs\").contain_front_matter,\n        contain_chapter: this.$store.getters[\"write/manuscriptProperty\"](\"configs\").contain_chapter,\n        contain_back_matter: this.$store.getters[\"write/manuscriptProperty\"](\"configs\").contain_back_matter,\n        auto_add_title: this.$store.getters[\"write/manuscriptProperty\"](\"configs\").auto_add_title\n      };\n      this.$store.dispatch(\"write/publishBook\", book\n      /*, { root: true }*/\n      ).then(function (data) {\n        console.log(\"data\", data);\n        var book_id = data.data.book.id;\n\n        _this7.assembleBook(book_id);\n\n        _this7.loading = false;\n\n        _this7.$q.notify({\n          color: \"positive\",\n          position: \"top\",\n          message: \"Yay! Your book has been published successfully on our bookstore\",\n          icon: \"error\"\n        });\n\n        _this7.$router.push({\n          name: \"app-read\"\n        });\n      }).catch(function (error) {\n        console.log(error);\n        var msg = \"\";\n\n        try {\n          msg = error.response.data.message;\n        } catch (_unused2) {\n          msg = \"Something went wrong. Please try refreshing the page\";\n        }\n\n        _this7.$q.notify({\n          color: \"negative\",\n          position: \"top\",\n          message: msg,\n          icon: \"error\"\n        });\n\n        _this7.loading = false;\n      });\n    },\n    assembleBook: function assembleBook(book_id) {\n      //If the response from the server is ok, loop and add each\n      //characters, frontmatters, chapters and back matters to the book\n      //Adding characters to the book\n      //Checking if characters exist\n      if (this.$store.getters[\"write/manuscriptProperty\"](\"configs\").contain_character) {\n        var characters = this.$store.getters[\"write/manuscriptProperty\"](\"characters\");\n\n        for (var i = 0; i < characters.length; i++) {\n          var character = characters[i];\n          character.book_id = book_id;\n          this.postChapter(character, \"characters\");\n        }\n      } //Adding front matters to the book\n      //Checking if front matters exist\n\n\n      if (this.$store.getters[\"write/manuscriptProperty\"](\"configs\").contain_front_matter) {\n        var front_matters = this.$store.getters[\"write/manuscriptProperty\"](\"front_matters\");\n\n        for (var i = 0; i < front_matters.length; i++) {\n          var front_matter = front_matters[i];\n          front_matter.book_id = book_id;\n          this.postChapter(front_matter, \"Front Matter\");\n        }\n      } //Adding chapters to the book\n\n\n      if (this.$store.getters[\"write/manuscriptProperty\"](\"configs\").contain_chapter) {\n        var chapters = this.$store.getters[\"write/manuscriptProperty\"](\"chapters\");\n\n        for (var i = 0; i < chapters.length; i++) {\n          var _chapter = chapters[i];\n          _chapter.book_id = book_id;\n          this.postChapter(_chapter, \"Chapter\");\n        }\n      } //Adding back_matters to the book\n\n\n      if (this.$store.getters[\"write/manuscriptProperty\"](\"configs\").contain_back_matter) {\n        var back_matters = this.$store.getters[\"write/manuscriptProperty\"](\"back_matters\");\n\n        for (var i = 0; i < back_matters.length; i++) {\n          var back_matter = back_matters[i];\n          back_matter.book_id = book_id;\n          this.postChapter(back_matter, \"Back Matter\");\n        }\n      }\n    },\n    postChapter: function postChapter(chap, type) {\n      var _this8 = this;\n\n      var payload = {\n        chapter: chap,\n        type: type,\n        isBook: true\n      };\n      this.$store.dispatch(\"write/addChapter\", payload\n      /*, { root: true }*/\n      ).then(function (data) {}).catch(function (error) {\n        _this8.$q.notify({\n          color: \"negative\",\n          position: \"top\",\n          message: error.response.data.message || \"Something went wrong\",\n          icon: \"error\"\n        });\n      });\n    },\n    onRejected: function onRejected(rejectedEntries) {\n      this.$q.notify({\n        type: \"negative\",\n        message: \"\".concat(rejectedEntries.length, \" file(s) did not pass validation constraints\")\n      });\n    }\n  }\n});\n// CONCATENATED MODULE: ./src/pages/write/ConfigPage.vue?vue&type=script&lang=js&\n /* harmony default export */ var write_ConfigPagevue_type_script_lang_js_ = (ConfigPagevue_type_script_lang_js_); \n// EXTERNAL MODULE: ./node_modules/quasar/src/components/page/QPage.js\nvar QPage = __webpack_require__(\"9989\");\n\n// EXTERNAL MODULE: ./node_modules/quasar/src/components/separator/QSeparator.js\nvar QSeparator = __webpack_require__(\"eb85\");\n\n// EXTERNAL MODULE: ./node_modules/quasar/src/components/input/QInput.js + 2 modules\nvar QInput = __webpack_require__(\"27f9\");\n\n// EXTERNAL MODULE: ./node_modules/quasar/src/components/tree/QTree.js + 4 modules\nvar QTree = __webpack_require__(\"7f41\");\n\n// EXTERNAL MODULE: ./node_modules/quasar/src/components/spinner/QSpinnerHourglass.js\nvar QSpinnerHourglass = __webpack_require__(\"9149\");\n\n// EXTERNAL MODULE: ./node_modules/quasar/src/components/dialog/QDialog.js\nvar QDialog = __webpack_require__(\"24e8\");\n\n// EXTERNAL MODULE: ./node_modules/quasar/src/components/card/QCard.js\nvar QCard = __webpack_require__(\"f09f\");\n\n// EXTERNAL MODULE: ./node_modules/quasar/src/components/card/QCardSection.js\nvar QCardSection = __webpack_require__(\"a370\");\n\n// EXTERNAL MODULE: ./node_modules/quasar/src/components/card/QCardActions.js\nvar QCardActions = __webpack_require__(\"4b7e\");\n\n// EXTERNAL MODULE: ./node_modules/quasar/src/directives/ClosePopup.js\nvar ClosePopup = __webpack_require__(\"7f67\");\n\n// CONCATENATED MODULE: ./src/pages/write/ConfigPage.vue\n\n\n\n\n\n/* normalize component */\n\nvar ConfigPage_component = Object(componentNormalizer[\"a\" /* default */])(\n  write_ConfigPagevue_type_script_lang_js_,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* harmony default export */ var ConfigPage = __webpack_exports__[\"default\"] = (ConfigPage_component.exports);\n\n\n\n\n\n\n\n\n\n\n\nruntime_auto_import_default()(ConfigPage_component, 'components', {QPage: QPage[\"a\" /* default */],QSeparator: QSeparator[\"a\" /* default */],QInput: QInput[\"a\" /* default */],QBtn: QBtn[\"a\" /* default */],QTree: QTree[\"a\" /* default */],QSpinnerHourglass: QSpinnerHourglass[\"a\" /* default */],QDialog: QDialog[\"a\" /* default */],QCard: QCard[\"a\" /* default */],QCardSection: QCardSection[\"a\" /* default */],QCardActions: QCardActions[\"a\" /* default */]});runtime_auto_import_default()(ConfigPage_component, 'directives', {ClosePopup: ClosePopup[\"a\" /* default */]});\n\n\n/***/ })\n\n}]);","inputSourceMap":null}